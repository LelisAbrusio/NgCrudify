<section class="form-shell">
  <header class="form-header">
    <h1>{{ isEdit ? 'Edit Character' : 'Create Character' }}</h1>
    <div class="header-actions">
      <button mat-stroked-button routerLink="/characters">
        <mat-icon>arrow_back</mat-icon>
        Back to list
      </button>
    </div>
  </header>

  <div class="form-grid">
    <!-- Left: Form fields -->
    <form class="form-fields" [formGroup]="form" (ngSubmit)="submit()">
      <!-- Name -->
      <mat-form-field appearance="fill">
        <mat-label>Name</mat-label>
        <input matInput formControlName="name" autocomplete="off" />
        <mat-error *ngIf="hasError('name','required')">Name is required</mat-error>
        <mat-error *ngIf="hasError('name','minlength')">At least 2 characters</mat-error>
      </mat-form-field>

      <!-- Species -->
      <mat-form-field appearance="fill">
        <mat-label>Species</mat-label>
        <input matInput formControlName="species" autocomplete="off" />
        <mat-error *ngIf="hasError('species','required')">Species is required</mat-error>
      </mat-form-field>

      <!-- Status -->
      <div class="status-row" matTooltip="Character status">
        <label class="status-label">Status</label>
        <mat-button-toggle-group formControlName="status" class="status-toggle" hideSingleSelectionIndicator>
          <mat-button-toggle value="Alive">
            <mat-icon>favorite</mat-icon> Alive
          </mat-button-toggle>
          <mat-button-toggle value="Dead">
            <mat-icon>skull</mat-icon> Dead
          </mat-button-toggle>
          <mat-button-toggle value="unknown">
            <mat-icon>help</mat-icon> Unknown
          </mat-button-toggle>
        </mat-button-toggle-group>
      </div>

      <!-- Image URL -->
      <mat-form-field appearance="fill">
        <mat-label>Image URL</mat-label>
        <input matInput formControlName="image" placeholder="https://..." />
        <mat-error *ngIf="hasError('image','required')">Image URL is required</mat-error>
      </mat-form-field>

      <!-- Sticky actions -->
      <div class="form-actions">
        <button mat-button type="button" (click)="cancel()">Cancel (Esc)</button>
        <button mat-raised-button color="primary" [disabled]="form.invalid">
          <mat-icon>save</mat-icon>
          Save (Ctrl/Cmd+Enter)
        </button>
      </div>
    </form>

    <!-- Right: Live preview -->
    <aside class="preview">
      <mat-card class="preview-card">
        <div class="preview-media">
          <img [src]="imagePreview" alt="Preview" />
        </div>
        <mat-card-content>
          <h3 class="preview-title">{{ form.value.name || 'Name' }}</h3>
          <p class="preview-meta">
            <span>{{ form.value.species || 'Species' }}</span>
            <span class="dot">â€¢</span>
            <span>{{ form.value.status }}</span>
          </p>
        </mat-card-content>
      </mat-card>
    </aside>
  </div>
</section>
